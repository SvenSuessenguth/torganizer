// Jenkins need to install the following additional plugins:
// https://updates.jenkins.io/download/plugins/
// SonarQube Scanner
// Warnings Next Generation

pipeline {

  agent any

  environment {
    CONFIGURATION = readJSON file: 'configuration-dev.json'
  }

  options {
    buildDiscarder(logRotator(daysToKeepStr: '3', numToKeepStr: '3', artifactNumToKeepStr: '3'))
    durabilityHint('PERFORMANCE_OPTIMIZED')
  }

  triggers {
    pollSCM('* * * * *')
  }

  stages {
    stage('prepare') {
      steps {
        script {
          echo CONFIGURATION
          echo "${CONFIGURATION.servers[1]"

          for (int i = 0; i < CONFIGURATION.servers.size(); ++i) {
            echo "Server ${CONFIGURATION.servers[i]}"
          }
        }
      }
    }
  }
}

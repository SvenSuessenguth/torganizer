// Jenkins need to install the following additional plugins:
// https://updates.jenkins.io/download/plugins/
// SonarQube Scanner
// Warnings Next Generation

pipeline {

  agent any

  tools {
    maven 'apache-maven-3.6'
  }
			
  stages {  
    stage('jdks') {
      matrix {
        axes {
		  axis {
		    name 'jdk'
			values 'openjdk-8', 'openjdk-13'
		  }
        }
      }
		
      stages {		  
        stage('compile') {                      
		  steps {
            execute("mvn compile -T 4C")
          }
        }
		stage('test') {            
		  steps {
            execute("mvn test -T 4C")
          }
        }
      }
    }
  }
}


void execute(instruction) {
  if (isUnix()) {
    sh instruction
  } else {
    bat instruction
  }
}
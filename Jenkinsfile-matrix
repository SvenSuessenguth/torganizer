// Jenkins need to install the following additional plugins:
// https://updates.jenkins.io/download/plugins/
// SonarQube Scanner
// Warnings Next Generation

pipeline {

  agent any

  stages {
    stage('jdks') {
      matrix {
        agent any
        axes {
          axis {
            name 'jdk'
            values 'openjdk-8', 'openjdk-13'
          }                    
        }
        stages {
          stage('compile') {
            tools {
              maven 'apache-maven-3.6'
            }
          
		    steps {
			  execute("mvn compile test -T 4C")
            }
          }
        }
      }
    }
  }
}

void execute(instruction) {
  if (isUnix()) {
    sh instruction
  } else {
    bat instruction
  }
}